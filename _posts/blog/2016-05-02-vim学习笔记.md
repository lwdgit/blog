---
title: vim学习笔记
---

## 基本命令

J  快速删除换行，将两行合并
u  恢复
U  行恢复
ctrl+r 重作
i 在光标所在字符前面插入字符
a append在光标后面插入字符
x 删除当前光标后的字符
o 在光标下方建立一个新的空行，并把VIM切换到插入模式，然后你可以在这个新行内输入文本
O 在光标上方建立一个新的空行
9k 光标向上移动9行
3a! 添加3 个!号，相当于重复执行a命令3次
3x 重复执行3次x命令
ZZ 保存并退出
ctrl+z 临时退出 fg返回继续编辑
:q 退出
:q! 强制退出
:e! 重新装载原来的文件
07.4 自动建立备份文件

CTRL+]  标签跳转,当光标移动在两个竖线之间时可用（两个竖线表示超链接，在Vim里超级链接的术语是“标签”（tag））
CTRL+t  标签返回
CTRL+o   跳转到前一个位置

> 在帮助屏幕的顶上，有这样的记号：*help.txt*。"*"之间的名字被帮助系统用来定义一个标签（也就是超级链接的目标）

:help x 获取"x"命令的帮助
:help deleting 获取删除文本的说明
:help index 获取帮助索引
:help CTRL-A 获取"CTRL+A"的帮助
:help i_CTRL-A 获取插入模式下“CTRL+A”的帮助
:help 'number'
:help E37 获取E37错误的帮助 如当vim下面出现如下错误：E37: No write since last change (use ! to override)
:help 提供非常概括的帮助
:help user-toc.txt 用户手册的内容目录
:help :subject Ex-命令“subject” 如：help :help 关于如何得到help的帮助
:help v_CTRL-B 获取可视模式的“CTRL+B”的帮助
:help subject() 获取函数subject的帮助
:help pattern<Tab> 寻找“pattern”开的始的帮助标签
:help digraphs.txt 帮助文件“digraphs.txt”的顶部
:help pattern<Ctrl-D> 一次性列出所有匹配“pattern”的帮助标签
:helpgrep pattern 在所有帮助文件的全部文本中寻找"pattern",并跳到第一个匹配项，如果要继续匹配，可用:cn 下一个匹配，:cN 上一个匹配 :cfirst 前一个匹配 :clast 最后一个匹配 :copen :cclose 打开/关闭quickfix窗口
CTRL+SHIFT+T 在insert模式下增加缩进
CTRL+SHIFT+D 在insert模式下减少缩进

:set expandtab 输入tab时自动将其转化为空格
:set softtabstop 敲入tab时实际占有的列出
:set tabstop 一个tab键所占的列数
:set shiftwidth 缩进操作时的列数

w 一次移动一个词,光标在词首
3w 移动3个词，光标在词首
b 反向移动一个词，光标在词首
e 移动到下一个单词，光标在词尾
ge 移动到上一个单词，光标在词尾
$ 移动在当前行行尾
0 移动到当前行行首
^ 移动到当前行第一个非空字符
2$ 移动到一行的行尾，0及^不能添加数字

> 一个词以非单词字符结尾，如“.”, “-”或者“)”。如果要改变Vim认为是单词组成部分的字符，请参见‘iskeyword’选项

fh 查找当前行的h字符，并将光标移动至那个位置
Fh 反向查找当前行的h字符，并将光标移动至那个位置
3fl 查找当前行的第三个l字符
3Fl 反向查找当前行的第3个l字符
tx 查找当前行的x字符，并将光标移动到该字符前一个位置，Tx反向
> 以上几个命令可以用“;”重复，“,”反向重复，无论用哪个命令，光标永远不会移出当前行，哪怕这两行是一个连续的句子。

% 括号“()[]{}”匹配，可以用‘matchpairs’定义

gg 移动到文件首
G 移动到文件末
7G 移动行第7行
50% 移动到文件的中间，90%移动到文件差不多结尾的位置
H 移动到视野内的第一行 Home
M 移动到视野内的中间 Middle
L 移动到视野内的末尾 Last

CTRL+G 确定当前行号，全文总行数，光标以前的行占全文的百分比，以及列数

:set number 显示行号
:set nomumber 关闭行号，由于number是一个布尔类型的选项，在它前面加上no表示关闭它，布尔选项只会有两个值，on或者off。
:set ruler 在Vim窗口的右下角显示当前光标的位置。
> Vim有很多选项，除了布尔类型的，还有数值或者字符串数型的。

CTRL+U 向下滚动半屏，文字向上
CTRL+D 向上滚动半屏，文字向下
CTRL+E 向上滚动一行
CTRL+Y 向下滚动一行
CTRL+F 向下滚动一屏
CTRL+B 向上滚动一屏
zz 将光标放在屏幕中间位置
zt 将光标放到屏幕顶部
zb 将光标放到屏幕尾部
> 要使光标上下总保留几行处于视窗中用作上下文，可以使用‘scrolloff’选项

/include 查找“include”
?include 反向查找“include”
> 字符.*[]^%/\\~$?有特殊含义，如果要查找它们，需要在前面加上一个"\\"进行转义，查找下一个匹配项可以使用"n"命令。3n表示移动到第三个匹配点
\\> N表示反向查找上一个

:set ingorecase 忽略大小写。通常情况下，你查找的内容是区分大小写的。
/<Up> 可以显示最近的查找项
\* 查找当前光标上的单词
\# 反向查找当前光标上的单词。你可以在命令前加一个计数：3*表示查找第三次出现该单词的地方
/the\\> 表示查找以the结尾的单词。其中"\\>"是一个特殊的记号，表示只匹配单词末尾。类似的，"\\<"表示只匹配单词的开头。这样，要匹配一个完整的单词"the",只需：/\\<the\\>
:set hlsearch 高亮所有匹配到的地方
:set nohlsearch 关闭高亮
:nohlsearch 临时关闭高亮显示
:set incsearch 这个命令使Vim在你输入字符串的过程中就显示匹配点。用这个功能可以检查是否会被找到正确的匹配
:set nowrapscan 这个设置使得找到文件结尾(或开头)后停止查找。

如果你喜欢前面的选项，而且每次用Vim都要设置它，那么你可以把这些命令写到Vim的启动文件中

ZZ 存盘，保存，类似:wq
'' 两个单引号可以跳回原来的地方，一般一个移动即被称为一个“跳转”，这包括查找命令"/","?"，但不包括行内查找命令“fx”和“tx”
CTRL+o则表示跳转到较老的地方（提示:o表示older）
CTRL+i 表示跳转到一个较新的地方,<Tab>功能和其一致

:jumps 该命令能输出一个你可以跳往的位置的列表。最后一个你使用的标记会用">"标出来

## 标记
ma 用a标记当前光标的位置，你可以使用26个字母(a-z)对任意光标所在行进行标记，这些标记是不可见的，只是一个由Vim记住的位置。
'a 跳转到用a字母标记的位置
[ 最后修改的开始位置
] 最后修改的结束位置

### 操作符与动作

一个命令组合模式：操作符-动作。你首先输入一个操作符命令，例如："d"就是一个删除操作符，然后你输入一人动作命令，例如"4l"或者"w"。这种方法使你可以在任何你能越过的文本上执行各种操作。

### 修改文本

另一个操作符命令是"c"，表示修改，change。它的作用与"d"操作符相似，只是完成后会切换到插入模式。例如，“cw”修改一个词，更精确的说，它删除一个词，并切换到插入械。

#### 更多的修改命令

像"dd"可以删除一行一样，"cc"修改一整行。但它会保留这一行的缩进（前导空格）。
“d$”删除到行尾，"c$"则修改到行尾。这相当于先用"d$"删除一行再用“a”启动插入模式，以便加入新的文字。

#### 快捷键

有些“操作符-动作”命令由于经常被使用，所以被设置为单字符命令:

  * x 表示 dl (删除当前光标下的字符)
  * X 表示 dh (删除光标左边的字符)
  * D 表示 d$ (删除到行尾)
  * C 表示 c$ (修改到行尾)
  * s 表示 cl (修改一个字符)
  * S 表示 cc (修改一整行)

#### 在什么地方加入计数前缀

命令“d3w”和"3dw"都是删除3个单词。“d3w”表示删除3个单词1次，"3dw"表示删除一个单词3次。实际上你可以放两个计数前缀，例如："3d2w"，表示删除两个单词3次。共计6个单词。

#### 替换单个字符

"r" 命令不是操作符，它只是等你输入一个字符然后用这个字符替换当前光标上的字符。你可以用"cl"命令或者"s"命令完成相同的功能，但"r"命令不需要使用<Ese>退出插入状态。

要用换行符替换一个字符可以用命令"r<Enter>"。这会删除一个字符并插入一个换行符。在这里使用计数前缀会删除多个字符但只插入一个换行符：“4r<Enter>”用一个换行符替换4个字符。

### 重复一个修改
. 重复最后一次的修改操作。例如，假设你在编辑一个HTML文件，你想删除所有的<B>标记。你把光标移动到第一个"<"上，然后用"df>"命令删除<B>。然后你就可以移动到</B>的<上面用"."命令删除它。然后移动到</B>的<上面，用"."命令删除它。"."命令执行最后一次的修改命令。
> "." 命令重复任何除"u"，"CTRL+R"以及冒号命令外的修改


### 可视模式

要删除一些简单的东西，用“操作符-动作”命令可以完成得很好。但很多情况下，并不容易确定用什么命令可以移动到你想修改的地方。这时候，你就需要可视模式了。

#### 按行选择

如果你想对整行做操作，可以使用"V"命令来启动可视模式。你会发现在你作任何移动之前。整行都被高亮显示了。左右移动不会有任何效果。而通过上下移动，你可以一次选择多行。

#### 移动到另一端

如果你在可视模式下选中了一些文字，然后你又发现你需要改变被选择的文字的另一端，用命令即可（提示：“o”表示ohter end），光标会移动到被选文字的另一端，现在你可以移动光标去改变选中文的开始点了。再按“o”光标还会回到另一端。
> 在可视区块的首尾来回跳转

#### 移动文本

当你用"d"，"x"或者其它命令删除文本的时候，这些文字会被存起来。你可以用p命令重新粘贴出来(p在Vim中表示put，放置)

> 关于粘贴的更多知识

"P"命令像"p"一样也是插入字符，但插入点在光标前面，当用你“dd”删除一行，"p"会把它插入到光标所在行的前一行。而当你用"dw"删除一个单词，"P"会把它插入到光标前面。"p"和"P"也接受计数前缀，被插入的文本会被插入指定的次数。所以"dd"后加一个"3p"会把删除行的三个拷贝插入到文本中。

### 拷贝文本

要把文本从一个地方拷贝到另一个地方，你可以先删除它，然后用"u"命令恢复，再用用"p"拷到另一个地方。这里还有一种简单的方法：抽出(yank)。"y"命令可以把文本拷贝到寄存器中。然后用"p"命令粘贴到别处。

yanking是Vim中拷贝命令的名字，由于"c"已经被用于表示change了，所以拷贝(copy)就不能再用"c"了，但"y"还是可用的。把这个命令称为"yanking"是为了更容易记住"y"这个键。

yw 拷贝包括单词后面的空白字符
ye 拷贝一个单词，但不包含其后的空白字符
Y 拷贝一行(注：D是删除到行尾)
yy 拷贝一行


### 使用剪切板

如果你使用Vim的GUI版本(gvim)，你可以在"Edit"菜单中找到"Copy"项，然后用可视模式选中一些文本，最后用Edit/Copy菜单。
如果你已经从其它程度中拷贝了一些文字到剪贴板，你可以在Vim中用Edir/Paste菜单粘贴进来。这在普通模式和插入模式中都是有效的。如果在可视模式。被选中的文字会替换掉。

如果你用的不是GUI，或者你根本不喜欢用菜单，你只能用其它办法了。你还是可以用普通的"y"和"p"命令，但在前面必须加上"*(一个双引号+一个星号)。

> 测试无效。待更多研究。

### 文本对象

如果你在一个单词的中间而又想删掉这个单词，在你使用"dw"前，你必须稳到这个单词的开始处。这里还有一个更简单的方法："daw",意思为"delete a word"

使用文本对象是Vim中执行修改的第三种方法。我们已经有“操作符-动作”和可视模式两种了。现在我们又有了“操作符-文本对象”。
这种方法与“操作符-动作”很相似，但它不是操作于从当前位置到移动目标间的内容，而是对光标所在位置的“文本对象”进行操作。文本对象是作为一个整体来处理的。现在光标在对象的位置无关紧要。

cis 可以改变一个句子(Change Inner sentence)
dis 删除一个句子，但不删除后面的空白。(Deleting Inner Sentense)
das 删除一个句子包括后面的空白字符。(Deleting a Sentense)

> 你还可以在可视模式下使用文本对象。这样会选中一个文本对象。
你可以在这里找一个详细的文本对象列表|text-object|。

### 替换模式

"R"命令启动替换模式。在这个模式下，你输入的每个字符都会覆盖到当前光村上的字符。这会一直持续下去，直到你输入<Esc>

R 持续替换

### 结论

操作符，移动命令和文本对象可以有各种组合。你可以用N个操作符加上M个移动命令，组合出N*M个命令！还有很多方法可以删除文本。以下是一些经常用到的。

 * x 删除光标下的字符 （dl的快捷键）
 * X 删除光标前的字符  (dh的快捷键)
 * D 从当前位置删除到行尾 (d$的快捷键)
 * dw 从当前位置删除到下一个单词的开头
 * db 从当前位置删除到前一个单词的开头
 * diw 删除光标上的单词（不包括空白符）
 * daw 删除光标上的单词（包括空白符）
 * dG  删除到文件末
 * dgg 删除到文件首

> 如果你用"c"代替"d"，这会变成修改命令，而改用"y"，则变成拷贝命令等等。

还有一些常用的进行修改的命令，放在哪一章都不合适，列在这里：

* ~ 修改光标下字符的大小写,并移动到下一个字符。这不是一个操作符，所以你不连接一个动作命令。
* I  移动到当前行的第一个非空字符，并启动插入模式，同^i
* A 移动到行尾非启用插入模式，同$a

## 选项设置

### vimrc文件

要让Vim用你习惯的设置启动，你可以把这些设置写到一个叫vimrc的文件中。Vim会在启动的时候执行这个文件里的命令。

如果你已经有vimrc文件，可以这样编辑它：`:edit $MYVIMRC`

set nocompatible "关闭与Vi的兼容
set backspace=indent,eol,start "指明在插入模式下在哪里允许<BS>删除光标前面的字符，这三个值分别指：行首的空白，换行符和插入模式开始处之前的字符
set autoindent "开启自动缩进
set smartindent "开启智能缩进
if has("vms")
  set nobackup
else
  set backup
endif
"告诉Vim当覆盖一个文件时保留一个备份。但VMS系统除外，因为VMS系统会自动产生备份文件。备份文件的名字是在原来的文件名上加上"~"字符
set history=50 "保存50个命令和50个查找模式的历史。
set ruler "在Vim右下角显示当前光标的位置
set showcmd " 在Vim窗口右下角，标尺的右边显示未完成的命令。
set incsearch "输入部分查找模式时显示相应的匹配点
map Q gq "定义一个键映射。这将定义Q命令用来完成与“gq”操作符相同的功能。
vnoremap _g y:exe "grep /" . escape(@", '\\/') . "/ *.c *.h"<CR> "
                                    这是一个复杂映射，你可以看到该映射可以被用来执行相当复杂的操作。但其本质依然是一个命令序列而已，与你直接输入没有什么两样。

if &t_Co > 2 || has("gui_running")
  syntax_on
  set hlsearch
endif
"激活语法高亮功能，但仅在有色彩的时候才有效。'hlsearch'选项告诉Vim高亮上次查找模式匹配的地方。
filetype plugin indent on "启动文件类型探测，并开启相应插件

autocmd FileType text setlocal textwidth=78
"使Vim在一行长于78个字符的时候自动换行，但仅对纯文本文件有效。

autocmd BufReadPost *
 \ if line("'\"") > 1 && line("'\"") <= line("$") |
 \ exe "normal! g'\"" |
 \ endif
"
这又是一个自动命令。它被设置为在读入任何文件之后自动执行。后面那堆复杂的东西检查'"标记是否已被定义，如果是，则被转到该标记。行首的反斜杠用于把所有语句连成一行

### 简单键盘映射

:map <F5> i{<Esc>ea}<Esc> "F5是功能键的指代
:map \p i(<Esc>ea)<Esc> "映射\p为在单词两端加圆括号,在敲入\后立即敲入p即可
:map \c i{<Esc>ea}<Esc> "映射\c为在单词两端添加花括号

### 添加插件

Vim可以通过插件增强功能。插件其实是一个当Vim启动的时候能被自动执行的脚本。简单地把插件放在你Vim的plugin目录中就可以使它生效{仅在Vim编译时加入|+eval|特性时才有效}

Vim中有两种插件：
  全局插件：用于所有类型的文件
  文件类型插件：仅用于特定类型的文件


#### 全局插件

 

## 技巧

ggVG= 全局自动对缩进
vj> 缩进一行
10>> 缩进10行
10==自动缩进10行
vjjj<C-v>Ixxx<ESC> 列编辑